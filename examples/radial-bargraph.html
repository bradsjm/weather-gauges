<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Radial Bargraph Demo - SteelSeries v3</title>
    <link rel="icon" href="data:," />
    <link rel="stylesheet" href="./common.css" />
    <script type="importmap">
      {
        "imports": {
          "@bradsjm/steelseries-v3-core": "../packages/core/dist/index.js",
          "@bradsjm/steelseries-v3-elements": "../packages/elements/dist/index.js",
          "lit": "https://esm.sh/lit@3.2.1",
          "lit/": "https://esm.sh/lit@3.2.1/",
          "zod": "https://esm.sh/zod@3.24.1"
        }
      }
    </script>
    <script type="module">
      import '@bradsjm/steelseries-v3-elements'

      const gauge = document.querySelector('steelseries-radial-bargraph-v3')
      const valueInput = document.getElementById('value')
      const thresholdInput = document.getElementById('threshold')
      const out = document.getElementById('out')
      const log = document.getElementById('log')

      const write = (line) => {
        const stamp = new Date().toLocaleTimeString()
        log.textContent = `[${stamp}] ${line}\n${log.textContent}`.trim()
      }

      const sync = () => {
        const value = Number(valueInput.value)
        const threshold = Number(thresholdInput.value)
        const thresholdExceeded = value >= threshold
        gauge.setAttribute('value', String(value))
        gauge.setAttribute('threshold', String(threshold))
        gauge.setAttribute('led-visible', String(thresholdExceeded))
        out.textContent = `${value} (threshold ${threshold}, led ${thresholdExceeded ? 'on' : 'off'})`
      }

      valueInput.addEventListener('input', sync)
      thresholdInput.addEventListener('input', sync)

      gauge.addEventListener('ss3-value-change', (event) => {
        write(`value-change ${JSON.stringify(event.detail)}`)
      })
      gauge.addEventListener('ss3-error', (event) => {
        write(`error ${JSON.stringify(event.detail)}`)
      })

      sync()
    </script>
  </head>
  <body>
    <header class="topbar">
      <strong>Radial Bargraph Demo</strong>
      <a href="./index.html">Back to index</a>
    </header>
    <main class="container">
      <p class="lead">Radial bargraph with classic SteelSeries framing, LEDs, and LCD readout.</p>

      <div class="card" style="max-width: 420px">
        <steelseries-radial-bargraph-v3
          class="legacy-theme"
          title="Flow"
          unit="L/min"
          value="48"
          min-value="0"
          max-value="100"
          threshold="80"
          use-section-colors="true"
          led-visible="true"
        ></steelseries-radial-bargraph-v3>
        <div class="controls">
          <label>Value</label>
          <input id="value" type="range" min="0" max="100" value="48" />
          <label>Threshold</label>
          <input id="threshold" type="range" min="30" max="95" value="80" />
          <div>Current: <strong id="out">48</strong></div>
        </div>
        <pre id="log" class="event-log"></pre>
      </div>
    </main>
  </body>
</html>
